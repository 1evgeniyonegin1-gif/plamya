# Changelog –∑–∞ 24 —è–Ω–≤–∞—Ä—è 2026

## –†–µ–∑—é–º–µ

**–ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –ø—Ä–æ–µ–∫—Ç–∞** —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ YandexGPT Pro 32K (–ª—É—á—à–∞—è –º–æ–¥–µ–ª—å)
- Post-processing –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π AI
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ —Ñ–æ—Ç–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
- –ü–µ—Ä–µ—Ö–æ–¥ –∫—É—Ä–∞—Ç–æ—Ä–∞ –Ω–∞ –¥–∏–∞–ª–æ–≥–æ–≤—ã–π —Ä–µ–∂–∏–º
- –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ –∫–æ–¥–∞

---

## 1. YandexGPT Pro 32K

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Å–ª–∞–±–∞—è –º–æ–¥–µ–ª—å `yandexgpt-lite`, –∫–æ—Ç–æ—Ä–∞—è –ø–ª–æ—Ö–æ —Å–ª–µ–¥–æ–≤–∞–ª–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º.

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –ª—É—á—à—É—é –º–æ–¥–µ–ª—å `yandexgpt-32k`.

**–ì—Ä–∞–Ω—Ç –Ø–Ω–¥–µ–∫—Å–∞:** 4000 —Ä—É–± (~1 –º–ª–Ω —Ç–æ–∫–µ–Ω–æ–≤)

| –ú–æ–¥–µ–ª—å | –¶–µ–Ω–∞ –∑–∞ 1K —Ç–æ–∫–µ–Ω–æ–≤ | –ö–∞—á–µ—Å—Ç–≤–æ |
|--------|-------------------|----------|
| yandexgpt-lite | 0.20 —Ä—É–± | –°–ª–∞–±–æ–µ |
| yandexgpt | 1.20 —Ä—É–± | –•–æ—Ä–æ—à–µ–µ |
| **yandexgpt-32k** | 3.90 —Ä—É–± | –û—Ç–ª–∏—á–Ω–æ–µ |

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `shared/config/settings.py:56` - –¥–µ—Ñ–æ–ª—Ç –∏–∑–º–µ–Ω—ë–Ω –Ω–∞ `yandexgpt-32k`

```python
# –ë—ã–ª–æ:
yandex_model: str = Field(default="yandexgpt-lite", env="YANDEX_MODEL")

# –°—Ç–∞–ª–æ:
yandex_model: str = Field(default="yandexgpt-32k", env="YANDEX_MODEL")
```

**–ù–∞ VPS –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å .env:**
```bash
YANDEX_MODEL=yandexgpt-32k
```

---

## 2. Post-processing –¥–ª—è AI

**–ü—Ä–æ–±–ª–µ–º–∞:** AI –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª hooks (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—Ä–∞–∑—ã –≤ –Ω–∞—á–∞–ª–µ) –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —ç–º–æ–¥–∑–∏.

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω post-processing, –∫–æ—Ç–æ—Ä—ã–π:
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ hook –≤ –Ω–∞—á–∞–ª–µ —Ç–µ–∫—Å—Ç–∞ –∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –µ—Å–ª–∏ –Ω–µ—Ç
2. –°—á–∏—Ç–∞–µ—Ç —ç–º–æ–¥–∑–∏ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ—Å–ª–∏ –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º—É–º–∞ –¥–ª—è –ø–µ—Ä—Å–æ–Ω—ã

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `content_manager_bot/ai/content_generator.py`

**–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:**

```python
def _apply_post_processing(
    self,
    content: str,
    persona_context: Optional[PersonaContext]
) -> str:
    """
    –ü—Ä–∏–º–µ–Ω—è–µ—Ç post-processing –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ —Å–æ–±–ª—é–¥–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π AI.

    1. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π hook - –µ—Å–ª–∏ AI –Ω–µ –Ω–∞—á–∞–ª —Å hook, –≤—Å—Ç–∞–≤–ª—è–µ–º –µ–≥–æ
    2. –í–∞–ª–∏–¥–∞—Ü–∏—è —ç–º–æ–¥–∑–∏ - –µ—Å–ª–∏ –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º—É–º–∞, –¥–æ–±–∞–≤–ª—è–µ–º
    """
    ...

def _count_emojis(self, text: str) -> int:
    """–ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–º–æ–¥–∑–∏ –≤ —Ç–µ–∫—Å—Ç–µ"""
    ...
```

**–ú–∏–Ω–∏–º—É–º —ç–º–æ–¥–∑–∏ –ø–æ –ø–µ—Ä—Å–æ–Ω–∞–º:**
| –ü–µ—Ä—Å–æ–Ω–∞ | –ú–∏–Ω–∏–º—É–º —ç–º–æ–¥–∑–∏ |
|---------|---------------|
| crazy | 5 |
| friend | 4 |
| rebel | 3 |
| expert | 2 |
| philosopher | 2 |
| tired | 1 |

---

## 3. –§–æ—Ç–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (unified_products/)

**–ü—Ä–æ–±–ª–µ–º–∞:** `ProductReferenceManager` –∏—Å–∫–∞–ª —Ñ–æ—Ç–æ –≤ `content/product_images/`, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ –ª–µ–∂–∞—Ç –≤ `content/unified_products/`.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø—É—Ç—å –∏ –¥–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ.

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `content_manager_bot/utils/product_reference.py`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ unified_products/:**
```
content/unified_products/
‚îú‚îÄ‚îÄ greenflash/
‚îÇ   ‚îú‚îÄ‚îÄ omega3/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ photos/*.jpg
‚îÇ   ‚îú‚îÄ‚îÄ vision_plus/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ photos/*.jpg
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ lovely/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ energy_diet/
    ‚îî‚îÄ‚îÄ ...
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ:**
```python
# –ë—ã–ª–æ:
base_path = project_root / "content" / "product_images"

# –°—Ç–∞–ª–æ:
base_path = project_root / "content" / "unified_products"
```

**–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ `_find_product_photo()`:**
- –ò—â–µ—Ç —Ñ–æ—Ç–æ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ `{brand}/{product}/photos/*.jpg`
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç .jpg –∏ .png
- –ö—ç—à–∏—Ä—É–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—É—Ç–∏

---

## 4. –î–∏–∞–ª–æ–≥–æ–≤—ã–π –∫—É—Ä–∞—Ç–æ—Ä

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö—É—Ä–∞—Ç–æ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª reply-–∫–Ω–æ–ø–∫–∏ (üçé –ó–¥–æ—Ä–æ–≤—å–µ, üíº –ë–∏–∑–Ω–µ—Å), —á—Ç–æ –≤—ã–≥–ª—è–¥–µ–ª–æ –Ω–µ–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ:** –£–±—Ä–∞–Ω—ã –≤—Å–µ reply-–∫–Ω–æ–ø–∫–∏, –∫—É—Ä–∞—Ç–æ—Ä —Ç–µ–ø–µ—Ä—å –≤–µ–¥—ë—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥.

**–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:**
- `curator_bot/handlers/commands.py` - /start –±–µ–∑ –∫–Ω–æ–ø–æ–∫
- `curator_bot/handlers/messages.py` - —É–±—Ä–∞–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫

**–ù–æ–≤–æ–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ /start:**
```python
welcome_text = f"""–ü—Ä–∏–≤–µ—Ç, {first_name}! üëã

–Ø –î–∞–Ω–∏–ª ‚Äî —Ç–≤–æ–π AI-–ø–æ–º–æ—â–Ω–∏–∫ –≤ NL International.

–†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Ç–µ–±—è –ø—Ä–∏–≤–µ–ª–æ? –ú–æ–∂–µ—Ç, –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –¥–ª—è –∑–¥–æ—Ä–æ–≤—å—è? –ò–ª–∏ —Ö–æ—á–µ—à—å —É–∑–Ω–∞—Ç—å –ø—Ä–æ –±–∏–∑–Ω–µ—Å-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏?

–ü—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏, –∫–∞–∫ –±—É–¥—Ç–æ –æ–±—â–∞–µ—à—å—Å—è —Å –¥—Ä—É–≥–æ–º üòä"""
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ—Ä–æ–Ω–∫–∞:**
1. `conversational_funnel.py` –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —ç—Ç–∞–ø: greeting ‚Üí discovery ‚Üí solution ‚Üí closing
3. –í—ã—è–≤–ª—è–µ—Ç –±–æ–ª–∏ –∏ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è
4. –í–µ–¥—ë—Ç –∫ –ø—Ä–æ–¥—É–∫—Ç—É/–±–∏–∑–Ω–µ—Å—É –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –¥–∏–∞–ª–æ–≥–æ–º

---

## 5. –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ –∫–æ–¥–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–¥ –ø–µ—Ä—Å–æ–Ω –¥—É–±–ª–∏—Ä–æ–≤–∞–ª—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö.

**–£–¥–∞–ª–µ–Ω–æ:**
- `content_manager_bot/mood/` - –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–æ `shared/persona/`
- `content_manager_bot/hooks/` - –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–æ `shared/persona/`

**–ê–∫—Ç—É–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:**
- `shared/persona/persona_config.py` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω
- `shared/persona/persona_context.py` - –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

---

## –î–µ–ø–ª–æ–π –Ω–∞ VPS

```bash
# 1. –õ–æ–∫–∞–ª—å–Ω–æ
git add .
git commit -m "Audit: YandexGPT Pro 32K, post-processing, unified_products, conversational curator"
git push

# 2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@194.87.86.103
cd /root/nl-international-ai-bots
git pull

# 3. –û–±–Ω–æ–≤–∏—Ç—å .env (–º–æ–¥–µ–ª—å)
nano .env
# –ò–∑–º–µ–Ω–∏—Ç—å: YANDEX_MODEL=yandexgpt-32k

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
systemctl restart nl-bots
journalctl -u nl-bots -f
```

---

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

| –§–∞–π–ª | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|------|-----------|
| `shared/config/settings.py` | –î–µ—Ñ–æ–ª—Ç –º–æ–¥–µ–ª–∏ ‚Üí yandexgpt-32k |
| `content_manager_bot/ai/content_generator.py` | +post-processing, +emoji validation |
| `content_manager_bot/utils/product_reference.py` | –ü—É—Ç—å ‚Üí unified_products/ |
| `curator_bot/handlers/commands.py` | /start –±–µ–∑ –∫–Ω–æ–ø–æ–∫ |
| `curator_bot/handlers/messages.py` | –£–±—Ä–∞–Ω—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ |
| `CLAUDE.md` | –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |

## –§–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã

- `content_manager_bot/mood/` (–≤—Å—è –ø–∞–ø–∫–∞)
- `content_manager_bot/hooks/` (–≤—Å—è –ø–∞–ø–∫–∞)

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. [ ] –û–±–Ω–æ–≤–∏—Ç—å .env –Ω–∞ VPS: `YANDEX_MODEL=yandexgpt-32k`
2. [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–æ—Å—Ç–æ–≤ —Å –Ω–æ–≤–æ–π –º–æ–¥–µ–ª—å—é
3. [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –∫—É—Ä–∞—Ç–æ—Ä–∞ –≤ –¥–∏–∞–ª–æ–≥–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
4. [ ] –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ file_id —Å—Ç–∏–∫–µ—Ä–æ–≤ –≤ MediaManager
