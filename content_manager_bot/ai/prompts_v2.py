"""
–ü—Ä–æ–º–ø—Ç—ã v2 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

–§–ò–õ–û–°–û–§–ò–Ø: –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ–º, –∞ –Ω–µ —Å–æ–∑–¥–∞—ë–º.
–†–µ–∞–ª—å–Ω–∞—è –ø–µ—Ä—Å–æ–Ω–∞ –î–∞–Ω–∏–ª–∞ ‚Äî –Ω–µ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π "–ø–∞—Ä–µ–Ω—å 21 –≥–æ–¥".
–¢—Ä—ë—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è: –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ ‚Üí –ü–∏—Å–∞—Ç–µ–ª—å ‚Üí –ö—Ä–∏—Ç–∏–∫.
"""
import random

from content_manager_bot.ai.style_dna import (
    PERSONA_INTERVIEW,
    PRIVATE_TOPICS,
    REALITY_CONSTRAINTS,
    ANTI_AI_WORDS_RU,
    get_random_topic,
    get_random_structure,
    get_random_ending,
    check_anti_ai_words,
    get_content_segment_overlay,
)

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ö–ê–ö –¢–´ –ü–ò–®–ï–®–¨
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

STYLE = """
–ü–∏—à–µ—à—å –∫–∞–∫ –±—É–¥—Ç–æ —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞–µ—à—å –¥—Ä—É–≥—É –≤ –±–∞—Ä–µ.
–ë–µ–∑ —Ü–µ–Ω–∑—É—Ä—ã. –ë–µ–∑ –ø–æ–ª–∏—Ç–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏.

–ú–ê–¢ (–æ—Ä–≥–∞–Ω–∏—á–Ω—ã–π, –Ω–µ –¥–ª—è —à–æ–∫–∞):
- "–∑–∞–µ–±–∏—Å—å", "–æ—Ö—É–µ–Ω–Ω—ã–π", "–ø–∏–∑–¥–µ—Ü", "—Ö—É–π–Ω—è"
- "–µ–±–∞—à–∏—Ç—å", "–Ω–∞—Ö—É—è", "–±–ª—è"
- "—Ö—É–π –∑–Ω–∞–µ—Ç", "–Ω–∞—Ö—É–π"
- –≠—Ç–æ –Ω–µ –¥–ª—è —ç–ø–∞—Ç–∞–∂–∞ ‚Äî —Ç–∞–∫ —Ä–µ–∞–ª—å–Ω–æ –≥–æ–≤–æ—Ä–∏—à—å

–†–ò–¢–ú –¢–ï–ö–°–¢–ê (–ö–†–ò–¢–ò–ß–ù–û ‚Äî —ç—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç —Ç–µ–±—è –æ—Ç –±–æ—Ç–∞):
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –†–ê–ó–ù–û–ô –¥–ª–∏–Ω—ã: –∫–æ—Ä–æ—Ç–∫–∏–µ (2-5 —Å–ª–æ–≤) —á–µ—Ä–µ–¥—É—é—Ç—Å—è —Å –¥–ª–∏–Ω–Ω—ã–º–∏ (15-25 —Å–ª–æ–≤)
- –ò–Ω–æ–≥–¥–∞ –æ–¥–Ω–æ —Å–ª–æ–≤–æ = –∞–±–∑–∞—Ü
- –ò–Ω–æ–≥–¥–∞ –¥–ª–∏–Ω–Ω–∞—è –º—ã—Å–ª—å –±–µ–∑ —Ç–æ—á–µ–∫
- –ù–ï –ü–ò–®–ò –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã –ø–æ–¥—Ä—è–¥ ‚Äî —ç—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫ AI

–ü–ê–ù–ß–ò (–∫–æ—Ä–æ—Ç–∫–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è):
- "–ù—É –≤–æ—Ç —Ç–∞–∫, –¥–∞."
- "–ù—É —Ö—É–π –∑–Ω–∞–µ—Ç."
- "–ü–æ—Å–º–æ—Ç—Ä–∏–º."
- "–ü–æ—à—ë–ª –¥–µ–ª–∞—Ç—å."
- –ò–ª–∏ –æ–±—Ä—ã–≤ –º—ã—Å–ª–∏ –Ω–∞ –ø–æ–ª—É—Å–ª–æ–≤–µ

–§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï:
- –ö–æ—Ä–æ—Ç–∫–∏–µ –∞–±–∑–∞—Ü—ã (1-3 —Å—Ç—Ä–æ–∫–∏)
- –ú–Ω–æ–≥–æ –≤–æ–∑–¥—É—Ö–∞ –º–µ–∂–¥—É –º—ã—Å–ª—è–º–∏
- –≠–º–æ–¥–∑–∏ –†–ï–î–ö–û (1-2 –Ω–∞ –ø–æ—Å—Ç –º–∞–∫—Å–∏–º—É–º, –ª—É—á—à–µ –±–µ–∑ –Ω–∏—Ö)
- –î–ª–∏–Ω–∞: 200-600 —Å–∏–º–≤–æ–ª–æ–≤ (–∫–æ—Ä–æ—á–µ = –ª—É—á—à–µ)
"""

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ó–ê–ü–†–ï–¢–´
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

FORBIDDEN = """
–ù–ò–ö–û–ì–î–ê –ù–ï –ü–ò–®–ò:

‚ùå –í–´–î–£–ú–ê–ù–ù–´–ï –î–ê–¢–´ –ò –¶–ò–§–†–´:
- "—Ç—Ä–∏ –≥–æ–¥–∞ –Ω–∞–∑–∞–¥", "5 –ª–µ—Ç –æ–ø—ã—Ç–∞", "87% –ª—é–¥–µ–π"
- –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—à—å —Ç–æ—á–Ω–æ ‚Äî –Ω–µ –ø–∏—à–∏
- –ò—Å–ø–æ–ª—å–∑—É–π: "–∫–∞–∫-—Ç–æ —Ä–∞–∑", "–Ω–µ–¥–∞–≤–Ω–æ", "–æ–¥–Ω–∞–∂–¥—ã"

‚ùå –ü–†–û–î–ê–Æ–©–ò–ï –°–õ–û–í–ê:
- "—É–Ω–∏–∫–∞–ª—å–Ω—ã–π", "–Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–π", "–ø–æ—Ç—Ä—è—Å–∞—é—â–∏–π", "–≤–æ–ª—à–µ–±–Ω—ã–π"
- "—Ç–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è", "–ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–Ω—Å", "—É—Å–ø–µ–π"
- –õ—é–±–æ–π —Ä–µ–∫–ª–∞–º–Ω—ã–π –±—É–ª–ª—à–∏—Ç

‚ùå –®–ê–ë–õ–û–ù–ù–´–ï –ù–ê–ß–ê–õ–ê:
- "–°–ª—É—à–∞–π,", "–î—Ä—É–∑—å—è,", "–ó–Ω–∞–µ—Ç–µ —á—Ç–æ,"
- "–í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ...", "–ú–Ω–æ–≥–∏–µ –ª—é–¥–∏..."
- "–•–æ—á—É –ø–æ–¥–µ–ª–∏—Ç—å—Å—è..."

‚ùå –¢–ï–ú–´ –ù–ï –¢–í–û–ï–ô –†–ï–ê–õ–¨–ù–û–°–¢–ò:
- –î–µ—Ç–∏, –¥–µ–∫—Ä–µ—Ç, —Å–µ–º–µ–π–Ω—ã–π –±—ã—Ç
- "–ú—É–∂ —Å–∫–∞–∑–∞–ª...", "–î–µ—Ç–∏ —Ä–∞–∑–ª–∏–ª–∏ –∫–∞—à—É..."
- –ò—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ –ø–∞—Ä—Ç–Ω—ë—Ä–æ–≤ –∫–æ—Ç–æ—Ä—ã—Ö —É —Ç–µ–±—è –Ω–µ—Ç

‚ùå –ü–†–ò–ó–´–í–´ –ö –î–ï–ô–°–¢–í–ò–Æ –í –ö–ê–ñ–î–û–ú –ü–û–°–¢–ï:
- "–ü–∏—à–∏ –≤ –±–æ—Ç–∞", "–ü–µ—Ä–µ—Ö–æ–¥–∏ –ø–æ —Å—Å—ã–ª–∫–µ"
- CTA —Ç–æ–ª—å–∫–æ –≤ 20% –ø–æ—Å—Ç–æ–≤, –∏ —Ç–æ –º—è–≥–∫–∏–π

‚ùå –°–ü–ò–°–ö–ò –° –ì–ê–õ–û–ß–ö–ê–ú–ò:
- ‚úîÔ∏è –í—ã–≤–æ–¥–∏—Ç —Ç–æ–∫—Å–∏–Ω—ã ‚úîÔ∏è –†–∞–∑–≥–ª–∞–∂–∏–≤–∞–µ—Ç –∫–æ–∂—É
- –≠—Ç–æ —Ä–µ–∫–ª–∞–º–∞ –∏–∑ 2015 –≥–æ–¥–∞

‚ùå AI-–°–õ–û–í–ê (–º–≥–Ω–æ–≤–µ–Ω–Ω–æ –≤—ã–¥–∞—é—Ç –±–æ—Ç–∞):
- "–±–µ–∑—É—Å–ª–æ–≤–Ω–æ", "–Ω–µ—Å–æ–º–Ω–µ–Ω–Ω–æ", "–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ"
- "—Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å", "–≤–∞–∂–Ω–æ –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å"
- "–±–æ–ª–µ–µ —Ç–æ–≥–æ", "–∫—Ä–æ–º–µ —Ç–æ–≥–æ", "–ø–æ–º–∏–º–æ —ç—Ç–æ–≥–æ"
- "–≤ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ", "–ø–æ–¥–≤–æ–¥—è –∏—Ç–æ–≥–∏", "—Ä–µ–∑—é–º–∏—Ä—É—è"
- "–¥–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º", "–∫–∞–∂–¥—ã–π –∏–∑ –Ω–∞—Å"
- "–ø–∞—Ä–∞–¥–∏–≥–º–∞", "—Å–∏–Ω–µ—Ä–≥–∏—è", "—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è"
- –õ—é–±—ã–µ –∫–Ω–∏–∂–Ω—ã–µ/–æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã
"""

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –¢–ò–ü–´ –ü–û–°–¢–û–í (–±–µ–∑ –ø—Ä–∏–º–µ—Ä–æ–≤ ‚Äî –ø—Ä–∏–º–µ—Ä—ã —É–±—Ä–∞–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

POST_TYPES = {
    "observation": {
        "name": "–ù–∞–±–ª—é–¥–µ–Ω–∏–µ",
        "description": "–ú—ã—Å–ª—å –æ —á—ë–º-—Ç–æ —á—Ç–æ –∑–∞–º–µ—Ç–∏–ª –≤ –∂–∏–∑–Ω–∏, –≤ –ª—é–¥—è—Ö, –≤ –º–∏—Ä–µ.",
        "cta": False,
        "prompt": """
–ù–∞–ø–∏—à–∏ –º—ã—Å–ª—å-–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ.

–ù–ï –æ–ø–∏—Å—ã–≤–∞–π —Å—Ü–µ–Ω—É "—è –≤–∏–∂—É –∫–æ–≥–æ-—Ç–æ" ‚Äî —Ç—ã –¥–æ–º–∞ –∑–∞ –∫–æ–º–ø–æ–º.
–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ ‚Äî –º—ã—Å–ª—å –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏—à–ª–∞ –≤ –≥–æ–ª–æ–≤—É. –û –ª—é–¥—è—Ö,
–æ –º–∏—Ä–µ, –æ —Ç–æ–º –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ –∂–∏–∑–Ω—å. –ò–∑ —Å–≤–æ–µ–≥–æ –æ–ø—ã—Ç–∞.

–ù–ï –¥–æ–±–∞–≤–ª—è–π –º–æ—Ä–∞–ª—å. –ù–ï –¥–µ–ª–∞–π –≤—ã–≤–æ–¥—ã –∑–∞ —á–∏—Ç–∞—Ç–µ–ª—è.
""",
    },

    "question": {
        "name": "–í–æ–ø—Ä–æ—Å",
        "description": "–ü—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å –±–µ–∑ –æ—Ç–≤–µ—Ç–∞. –ó–∞—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞–¥—É–º–∞—Ç—å—Å—è.",
        "cta": False,
        "prompt": """
–ù–∞–ø–∏—à–∏ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å.

–í–æ–ø—Ä–æ—Å –¥–æ–ª–∂–µ–Ω –∑–∞—Ü–µ–ø–∏—Ç—å, –∑–∞—Å—Ç–∞–≤–∏—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∏ –∑–∞–¥—É–º–∞—Ç—å—Å—è.
–ë–ï–ó –æ—Ç–≤–µ—Ç–∞ ‚Äî –ø—É—Å—Ç—å —á–∏—Ç–∞—Ç–µ–ª—å –¥—É–º–∞–µ—Ç —Å–∞–º.
–ú–æ–∂–µ—à—å –¥–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç, –Ω–æ –Ω–µ –æ—Ç–≤–µ—á–∞–π –Ω–∞ —Å–≤–æ–π –∂–µ –≤–æ–ø—Ä–æ—Å.
""",
    },

    "thought": {
        "name": "–ú—ã—Å–ª—å",
        "description": "–ú—ã—Å–ª—å –≤—Å–ª—É—Ö, —Ä–µ—Ñ–ª–µ–∫—Å–∏—è. –§–∏–ª–æ—Å–æ—Ñ–∏—è –±–µ–∑ –∑–∞–Ω—É–¥—Å—Ç–≤–∞.",
        "cta": False,
        "prompt": """
–ù–∞–ø–∏—à–∏ –º—ã—Å–ª—å –≤—Å–ª—É—Ö.

–ß—Ç–æ —Ç–µ–±—è –≤–æ–ª–Ω—É–µ—Ç, –æ —á—ë–º –¥—É–º–∞–µ—à—å. –†–∞–∑–≤–µ–π –º—ã—Å–ª—å.
–ù–µ –±—É–¥—å –∑–∞–Ω—É–¥–æ–π. –§–∏–ª–æ—Å–æ—Ñ–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∂–∏–≤–æ–π.
–í—ã–≤–æ–¥ –∏–ª–∏ "—Ö—É–π –∑–Ω–∞–µ—Ç" ‚Äî –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ–∫.
""",
    },

    "journey": {
        "name": "–ü—É—Ç—å",
        "description": "–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—É—Ç–∏ ‚Äî —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –±–µ–∑ –ø–∞—Ñ–æ—Å–∞.",
        "cta": "sometimes",
        "prompt": """
–ù–∞–ø–∏—à–∏ –ø–æ—Å—Ç –æ —Å–≤–æ—ë–º –ø—É—Ç–∏ ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

–ß—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ/–ø–æ–ø—Ä–æ–±–æ–≤–∞–ª. –ß–µ—Å—Ç–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è (–º–æ–∂–Ω–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω—É—é).
–≠—Ç–æ –ù–ï –∏—Å—Ç–æ—Ä–∏—è —É—Å–ø–µ—Ö–∞. –≠—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚Äî —Å —Ñ–µ–π–ª–∞–º–∏,
—Å–æ–º–Ω–µ–Ω–∏—è–º–∏, —Ç—É–ø–Ω—è–∫–æ–º. –ë–µ–∑ –ø—Ä–∏—É–∫—Ä–∞—à–∏–≤–∞–Ω–∏—è.
""",
    },

    "honesty": {
        "name": "–ß–µ—Å—Ç–Ω–æ—Å—Ç—å",
        "description": "–ü—Ä–∏–∑–Ω–∞–Ω–∏–µ –≤ –Ω–µ–∑–Ω–∞–Ω–∏–∏, —Å—Ç—Ä–∞—Ö–µ, —Å–æ–º–Ω–µ–Ω–∏—è—Ö. –£—è–∑–≤–∏–º–æ—Å—Ç—å = —Å–∏–ª–∞.",
        "cta": False,
        "prompt": """
–ù–∞–ø–∏—à–∏ —á–µ—Å—Ç–Ω—ã–π –ø–æ—Å—Ç –ø—Ä–æ —Å—Ç—Ä–∞—Ö–∏/—Å–æ–º–Ω–µ–Ω–∏—è/–Ω–µ–∑–Ω–∞–Ω–∏–µ.

–ß–µ—Å—Ç–Ω–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ. –ü–æ—á–µ–º—É —ç—Ç–æ —Ç–∞–∫. –ù–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –¥–µ–ª–∞–µ—à—å.
–£—è–∑–≤–∏–º–æ—Å—Ç—å = —Å–∏–ª–∞. –ù–æ –±–µ–∑ –Ω—ã—Ç—å—è –∏ –∂–∞–ª–æ–±.
""",
    },

    "absurd": {
        "name": "–ê–±—Å—É—Ä–¥",
        "description": "–ê–±—Å—É—Ä–¥–Ω—ã–π —é–º–æ—Ä, –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è.",
        "cta": False,
        "prompt": """
–ù–∞–ø–∏—à–∏ –∞–±—Å—É—Ä–¥–Ω—ã–π –ø–æ—Å—Ç —Å —é–º–æ—Ä–æ–º.

–ù–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å,
–∞–±—Å—É—Ä–¥–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è. –Æ–º–æ—Ä —á–µ—Ä–µ–∑ –∞–±—Å—É—Ä–¥.
–ü–∞–Ω—á –∏–ª–∏ "–ú–º–º..." –≤ –∫–æ–Ω—Ü–µ.
""",
    },

    "self_irony": {
        "name": "–°–∞–º–æ–∏—Ä–æ–Ω–∏—è",
        "description": "–°–º–µ—ë–º—Å—è –Ω–∞–¥ —Å–æ–±–æ–π. –ú–µ–º –≤ —Ç–µ–∫—Å—Ç–µ.",
        "cta": False,
        "prompt": """
–ù–∞–ø–∏—à–∏ —Å–∞–º–æ–∏—Ä–æ–Ω–∏—á–Ω—ã–π –ø–æ—Å—Ç.

–°–∏—Ç—É–∞—Ü–∏—è –≥–¥–µ —Ç—ã –≤—ã–≥–ª—è–¥–∏—à—å –≥–ª—É–ø–æ –∏–ª–∏ —Å–º–µ—à–Ω–æ.
–§–æ—Ä–º–∞—Ç "–Ø: ... / –†–µ–∞–ª—å–Ω–æ—Å—Ç—å: ..." —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ.
–°–º–µ–π—Å—è –Ω–∞–¥ —Å–æ–±–æ–π, –Ω–µ –Ω–∞–¥ –¥—Ä—É–≥–∏–º–∏.
""",
    },
}

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# –ì–ï–ù–ï–†–ê–¶–ò–Ø –ü–†–û–ú–ü–¢–û–í (—Ç—Ä—ë—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π –ø–∞–π–ø–ª–∞–π–Ω)
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

def get_system_prompt(segment: str = None) -> str:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å—Ç–æ–≤.

    Args:
        segment: –°–µ–≥–º–µ–Ω—Ç –∫–∞–Ω–∞–ª–∞ (zozh, business –∏ —Ç.–¥.) ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –æ–≤–µ—Ä–ª–µ–π —Ç–æ–Ω–∞
    """
    segment_block = ""
    if segment:
        overlay = get_content_segment_overlay(segment)
        if overlay and overlay.get("tone"):
            segment_block = f"\n\n‚ïê‚ïê‚ïê –ê–î–ê–ü–¢–ê–¶–ò–Ø –ü–û–î –ö–ê–ù–ê–õ ({overlay.get('name', segment)}) ‚ïê‚ïê‚ïê\n{overlay['tone']}\n"

    return f"""
{PERSONA_INTERVIEW}

{STYLE}

{FORBIDDEN}

{REALITY_CONSTRAINTS}

{PRIVATE_TOPICS}
{segment_block}
"""


def get_planner_prompt(post_type: str, custom_topic: str = None, recent_posts: list = None,
                       diary_entries: str = "", segment: str = None,
                       director_context: str = "") -> str:
    """
    –ü—Ä–æ–º–ø—Ç –¥–ª—è –ü–õ–ê–ù–ò–†–û–í–©–ò–ö–ê (—à–∞–≥ 1 –∏–∑ 3).
    –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–∏–¥—É–º—ã–≤–∞–µ—Ç –ø–ª–∞–Ω –ø–æ—Å—Ç–∞, –Ω–æ –ù–ï –ø–∏—à–µ—Ç —Ç–µ–∫—Å—Ç.

    Args:
        post_type: –¢–∏–ø –ø–æ—Å—Ç–∞
        custom_topic: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ–º–∞
        recent_posts: –°–ø–∏—Å–æ–∫ –Ω–µ–¥–∞–≤–Ω–∏—Ö –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ—Å—Ç–æ–≤ [(content_preview, post_type), ...]
        diary_entries: –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–ª–æ–∫ –¥–Ω–µ–≤–Ω–∏–∫–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π (–∏–ª–∏ –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞)
        segment: –°–µ–≥–º–µ–Ω—Ç –∫–∞–Ω–∞–ª–∞ (zozh, business –∏ —Ç.–¥.) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–º—ã –∏–∑ –æ–≤–µ—Ä–ª–µ—è
        director_context: –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ—Ç AI Director (channel memory + insights + rules + trends)
    """
    if post_type not in POST_TYPES:
        post_type = "observation"

    post_config = POST_TYPES[post_type]

    # –ï—Å–ª–∏ –µ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç ‚Äî –±–µ—Ä—ë–º —Ç–µ–º—É –∏–∑ –æ–≤–µ—Ä–ª–µ—è —Å–µ–≥–º–µ–Ω—Ç–∞
    if segment and not custom_topic:
        overlay = get_content_segment_overlay(segment)
        if overlay and overlay.get("topics_override"):
            topic = random.choice(overlay["topics_override"])
        else:
            topic = get_random_topic(post_type)
    else:
        topic = custom_topic or get_random_topic(post_type)

    structure = get_random_structure(post_type)

    # –î–ª—è —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ ‚Äî —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –∫–æ–Ω—Ü–æ–≤–æ–∫
    if segment:
        from content_manager_bot.ai.style_dna import ENDING_STYLES
        ending = random.choice(ENDING_STYLES)
    else:
        ending = get_random_ending()

    # –ü–∞–º—è—Ç—å: —á—Ç–æ —É–∂–µ –ø—É–±–ª–∏–∫–æ–≤–∞–ª–∏
    memory_block = ""
    if recent_posts:
        memory_block = "\n\n‚ö†Ô∏è –£–ñ–ï –û–ü–£–ë–õ–ò–ö–û–í–ê–ù–ù–´–ï –ü–û–°–¢–´ (–ù–ï –ü–û–í–¢–û–†–Ø–ô —ç—Ç–∏ —Ç–µ–º—ã –∏ –º—ã—Å–ª–∏):\n"
        for i, item in enumerate(recent_posts, 1):
            if len(item) == 3:
                preview, ptype, _ending = item
            else:
                preview, ptype = item
            memory_block += f"{i}. [{ptype}] {preview}\n"
        memory_block += "\n–ü—Ä–∏–¥—É–º–∞–π –ù–û–í–£–Æ —Ç–µ–º—É –∏ –ù–û–í–´–ô —É–≥–æ–ª. –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π –Ω–∏ –æ–¥–Ω—É –∏–∑ –º—ã—Å–ª–µ–π –≤—ã—à–µ.\n"

        # –ê–Ω—Ç–∏-–ø–æ–≤—Ç–æ—Ä –∫–æ–Ω—Ü–æ–≤–æ–∫: –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –∫–æ–Ω—Ü–æ–≤–æ–∫
        endings_data = [item[2] for item in recent_posts[:5] if len(item) == 3 and item[2]]
        if endings_data:
            memory_block += "\n‚ö†Ô∏è –ö–û–ù–¶–û–í–ö–ò –ü–û–°–õ–ï–î–ù–ò–• –ü–û–°–¢–û–í (–ù–ï –ø–æ–≤—Ç–æ—Ä—è–π –ø–æ—Ö–æ–∂–∏–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è):\n"
            for i, end in enumerate(endings_data, 1):
                memory_block += f"  –ö–æ–Ω–µ—Ü {i}: ¬´...{end}¬ª\n"
            memory_block += "–ö–∞–∂–¥—ã–π –ø–æ—Å—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –ü–û-–î–†–£–ì–û–ú–£. –ß–µ—Ä–µ–¥—É–π: –≤–æ–ø—Ä–æ—Å, –ø–∞–Ω—á, –æ–±—Ä—ã–≤, —é–º–æ—Ä, —Ç–∏—Ö–æ–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ.\n"

    # –ö–æ–Ω—Ç–µ–∫—Å—Ç –∫–∞–Ω–∞–ª–∞ (–¥–ª—è —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö)
    channel_context_block = ""
    if segment and recent_posts:
        seg_overlay = get_content_segment_overlay(segment)
        channel_name = seg_overlay.get("name", segment) if seg_overlay else segment
        total_posts = len(recent_posts)

        channel_context_block = f"""

üì∫ –ö–û–ù–¢–ï–ö–°–¢ –ö–ê–ù–ê–õ–ê ¬´{channel_name}¬ª:
- –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –ø–æ—Å—Ç–æ–≤: {total_posts}+
- –≠—Ç–æ –¢–í–û–ô —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–∞–Ω–∞–ª ‚Äî –≤–µ–¥–∏ –µ–≥–æ –∫–∞–∫ –∂–∏–≤–æ–π –±–ª–æ–≥
- –ú–æ–∂–Ω–æ —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ç–µ–º—ã: "–∫–∞–∫ —è –ø–∏—Å–∞–ª –Ω–µ–¥–∞–≤–Ω–æ", "–ø–æ–º–Ω–∏—Ç–µ —Ç–æ—Ç –ø–æ—Å—Ç –ø—Ä–æ..."
- –†–∞–∑–≤–∏–≤–∞–π —Ç–µ–º—ã –∫–∞–Ω–∞–ª–∞, –∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–π –∏—Ö
- –°–æ–∑–¥–∞–≤–∞–π –æ—â—É—â–µ–Ω–∏–µ —Å–µ—Ä–∏–∏ –∏ —Ä–∞–∑–≤–∏—Ç–∏—è
"""

    # –î–Ω–µ–≤–Ω–∏–∫: –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏ –∞–≤—Ç–æ—Ä–∞
    diary_block = diary_entries if diary_entries else ""

    # AI Director: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–º—è—Ç—å –∫–∞–Ω–∞–ª–∞, insights, –ø—Ä–∞–≤–∏–ª–∞
    director_block = ""
    if director_context:
        director_block = f"\n\n{director_context}\n"

    return f"""
–¢–∏–ø –ø–æ—Å—Ç–∞: {post_config['name']}
–¢–µ–º–∞ –¥–ª—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è: {topic}
{memory_block}{channel_context_block}{diary_block}{director_block}
–ü—Ä–∏–¥—É–º–∞–π –ü–õ–ê–ù –ø–æ—Å—Ç–∞ (–ù–ï –ø–∏—à–∏ —Å–∞–º –ø–æ—Å—Ç!). –û—Ç–≤–µ—Ç—å –∫—Ä–∞—Ç–∫–æ –ø–æ –ø—É–Ω–∫—Ç–∞–º:

1. –ì–õ–ê–í–ù–ê–Ø –ú–´–°–õ–¨ ‚Äî –æ —á—ë–º –ø–æ—Å—Ç –≤ –æ–¥–Ω–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏?
2. –≠–ú–û–¶–ò–Ø ‚Äî —á–µ—Ä–µ–∑ –∫–∞–∫—É—é —ç–º–æ—Ü–∏—é –∑–∞—Ö–æ–¥–∏–º? (—É–¥–∏–≤–ª–µ–Ω–∏–µ / –∑–ª–æ—Å—Ç—å / —Å–∞–º–æ–∏—Ä–æ–Ω–∏—è / —Å—Ç—Ä–∞—Ö / —é–º–æ—Ä / –≥—Ä—É—Å—Ç—å / –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å)
3. –ü–û–í–û–†–û–¢ ‚Äî –∫–∞–∫–æ–π –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç –∏–ª–∏ –∫–æ–Ω—Ç—Ä–∞—Å—Ç –±—É–¥–µ—Ç?
4. –°–¢–†–£–ö–¢–£–†–ê: {structure}
5. –ö–û–ù–¶–û–í–ö–ê: {ending}
6. –î–õ–ò–ù–ê ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–π (100-200 —Å–∏–º–≤–æ–ª–æ–≤) / —Å—Ä–µ–¥–Ω–∏–π (200-400) / –¥–ª–∏–Ω–Ω—ã–π (400-600)?

–¢–µ–º–∞ ‚Äî —ç—Ç–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º—ã—Å–ª–∏, –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ —ç—Ç–æ –¥–æ—Å–ª–æ–≤–Ω–æ.
–ü—Ä–∏–¥—É–º–∞–π —á—Ç–æ-—Ç–æ —Å–≤–æ—ë –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è.
"""


def get_writer_prompt(plan: str, post_type: str) -> str:
    """
    –ü—Ä–æ–º–ø—Ç –¥–ª—è –ü–ò–°–ê–¢–ï–õ–Ø (—à–∞–≥ 2 –∏–∑ 3).
    –ü–∏—Å–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ –ø–æ –ø–ª–∞–Ω—É.
    """
    if post_type not in POST_TYPES:
        post_type = "observation"

    post_config = POST_TYPES[post_type]

    return f"""
–í–æ—Ç –ø–ª–∞–Ω –ø–æ—Å—Ç–∞:

{plan}

–¢–µ–ø–µ—Ä—å –ù–ê–ü–ò–®–ò —Å–∞–º –ø–æ—Å—Ç. –í—ã–¥–∞–π –¢–û–õ–¨–ö–û —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞, –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π.

{post_config['prompt']}

–ü–†–ê–í–ò–õ–ê –ù–ê–ü–ò–°–ê–ù–ò–Ø:
- –ü–∏—à–∏ –∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –Ω–µ –∫–∞–∫ AI
- –†–∞–∑–Ω—ã–π —Ä–∏—Ç–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π: –∫–æ—Ä–æ—Ç–∫–∏–µ —á–µ—Ä–µ–¥—É—é—Ç—Å—è —Å –¥–ª–∏–Ω–Ω—ã–º–∏
- –ú–æ–∂–Ω–æ –æ–±–æ—Ä–≤–∞—Ç—å –º—ã—Å–ª—å –Ω–∞ –ø–æ–ª—É—Å–ª–æ–≤–µ
- –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å —Å–µ–±—è ("–Ω—É, –Ω–µ —Å–æ–≤—Å–µ–º... —Å–∫–æ—Ä–µ–µ...")
- –ù–ï –¥–µ–ª–∞–π "–∫—Ä–∞—Å–∏–≤—É—é" —Å—Ç—Ä—É–∫—Ç—É—Ä—É ‚Äî –ø–∏—à–∏ –∫–∞–∫ –¥—É–º–∞–µ—à—å
- –ú–∞—Ç ‚Äî –æ—Ä–≥–∞–Ω–∏—á–Ω—ã–π, –∫–∞–∫ –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–µ
- –ë–ï–ó AI-—Å–ª–æ–≤: "–±–µ–∑—É—Å–ª–æ–≤–Ω–æ", "—Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å", "–±–æ–ª–µ–µ —Ç–æ–≥–æ"
- –î–ª–∏–Ω–∞: 200-600 —Å–∏–º–≤–æ–ª–æ–≤
"""


def get_critic_prompt(draft: str) -> str:
    """
    –ü—Ä–æ–º–ø—Ç –¥–ª—è –ö–†–ò–¢–ò–ö–ê (—à–∞–≥ 3 –∏–∑ 3).
    –ö—Ä–∏—Ç–∏–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏ –ø—Ä–∞–≤–∏—Ç —Ç–µ–∫—Å—Ç —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å "–±–æ—Ç–æ–≤–æ—Å—Ç—å".
    """
    return f"""
–í–æ—Ç –ø–æ—Å—Ç:

---
{draft}
---

–ü—Ä–æ–≤–µ—Ä—å –∏ –∏—Å–ø—Ä–∞–≤—å. –í—ã–¥–∞–π –¢–û–õ–¨–ö–û —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞.

–ü–†–û–í–ï–†–¨:
1. –ï—Å—Ç—å –ª–∏ —Ñ—Ä–∞–∑—ã –∫–æ—Ç–æ—Ä—ã–µ –∑–≤—É—á–∞—Ç –∫–∞–∫ AI/–±–æ—Ç? ("—Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å", "–±–µ–∑—É—Å–ª–æ–≤–Ω–æ", "–±–æ–ª–µ–µ —Ç–æ–≥–æ") ‚Äî –∑–∞–º–µ–Ω–∏ –Ω–∞ –∂–∏–≤—ã–µ
2. –í—Å–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ–¥–Ω–æ–π –¥–ª–∏–Ω—ã? ‚Äî —Å–ª–æ–º–∞–π —Ä–∏—Ç–º (—Å–¥–µ–ª–∞–π –æ–¥–Ω–∏ –∫–æ—Ä–æ—á–µ, –¥—Ä—É–≥–∏–µ –¥–ª–∏–Ω–Ω–µ–µ)
3. –ï—Å—Ç—å –ª–∏ –≤—ã–¥—É–º–∞–Ω–Ω—ã–µ —Å—Ü–µ–Ω—ã? (–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –∑–∞ –ª—é–¥—å–º–∏ –≤ –º–µ—Ç—Ä–æ/–∫–æ—Ñ–µ–π–Ω–µ/–ø—Ä–æ–±–∫–µ) ‚Äî —É–±–µ—Ä–∏
4. –°–ª–∏—à–∫–æ–º "–ø—Ä–∞–≤–∏–ª—å–Ω–æ" –∏ "–≥–ª–∞–¥–∫–æ"? ‚Äî –¥–æ–±–∞–≤—å —à–µ—Ä–æ—Ö–æ–≤–∞—Ç–æ—Å—Ç—å, –Ω–µ–∑–∞–∫–æ–Ω—á–µ–Ω–Ω—É—é –º—ã—Å–ª—å
5. –ï—Å—Ç—å –ª–∏ –ø—Ä–æ–¥–∞—é—â–∏–µ —Å–ª–æ–≤–∞? ("—É–Ω–∏–∫–∞–ª—å–Ω—ã–π", "–Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–π") ‚Äî —É–±–µ—Ä–∏
6. –°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π (–±–æ–ª—å—à–µ 600 —Å–∏–º–≤–æ–ª–æ–≤)? ‚Äî —Å–æ–∫—Ä–∞—Ç–∏

–ï—Å–ª–∏ –ø–æ—Å—Ç —É–∂–µ —Ö–æ—Ä–æ—à–∏–π ‚Äî –≤–µ—Ä–Ω–∏ –∫–∞–∫ –µ—Å—Ç—å, –Ω–µ —É—Ö—É–¥—à–∞–π.
"""


def get_post_prompt(post_type: str, custom_topic: str = None) -> str:
    """
    Fallback: –æ–¥–Ω–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π –ø—Ä–æ–º–ø—Ç (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏).
    –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ—Å–ª–∏ —Ç—Ä—ë—Ö—Å—Ç—É–ø–µ–Ω—á–∞—Ç—ã–π –ø–∞–π–ø–ª–∞–π–Ω –æ—Ç–∫–ª—é—á—ë–Ω.
    """
    if post_type not in POST_TYPES:
        post_type = "observation"

    post_config = POST_TYPES[post_type]
    topic = custom_topic or get_random_topic(post_type)
    structure = get_random_structure(post_type)
    ending = get_random_ending()

    prompt = f"""
–¢–∏–ø –ø–æ—Å—Ç–∞: {post_config['name']}
–¢–µ–º–∞: {topic}

{post_config['prompt']}

–°–¢–†–£–ö–¢–£–†–ê:
{structure}

–ö–û–ù–¶–û–í–ö–ê:
{ending}

–í–ê–ñ–ù–û:
- –ü–∏—à–∏ –æ—Ç —Å–µ–±—è, –∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫
- –¢–µ–º–∞ ‚Äî –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º—ã—Å–ª–∏, –Ω–µ —Å—Ü–µ–Ω–∞—Ä–∏–π
- –†–∞–∑–Ω—ã–π —Ä–∏—Ç–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
- –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π AI-—Å–ª–æ–≤–∞
- –î–ª–∏–Ω–∞: 200-600 —Å–∏–º–≤–æ–ª–æ–≤
- –ö–æ—Ä–æ—Ç–∫–∏–µ –∞–±–∑–∞—Ü—ã, –º–Ω–æ–≥–æ –≤–æ–∑–¥—É—Ö–∞
"""

    if not post_config.get('cta'):
        prompt += "- –ë–ï–ó –ø—Ä–∏–∑—ã–≤–∞ –∫ –¥–µ–π—Å—Ç–≤–∏—é\n"

    return prompt


def validate_post(text: str) -> list:
    """
    –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ—Å—Ç–∞.

    Returns:
        list: –°–ø–∏—Å–æ–∫ –æ—à–∏–±–æ–∫ (–ø—É—Å—Ç–æ–π –µ—Å–ª–∏ –≤—Å—ë –æ–∫)
    """
    import re
    errors = []

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—ã–¥—É–º–∞–Ω–Ω—ã–µ –¥–∞—Ç—ã
    date_patterns = [
        r'\d+\s*(–ª–µ—Ç|–≥–æ–¥–∞|–≥–æ–¥)\s*–Ω–∞–∑–∞–¥',
        r'\d+\s*(–º–µ—Å—è—Ü–µ–≤|–º–µ—Å—è—Ü–∞|–º–µ—Å—è—Ü)\s*–Ω–∞–∑–∞–¥',
    ]
    for pattern in date_patterns:
        if re.search(pattern, text, re.IGNORECASE):
            errors.append("–í—ã–¥—É–º–∞–Ω–Ω–∞—è –¥–∞—Ç–∞ (X –ª–µ—Ç/–º–µ—Å—è—Ü–µ–≤ –Ω–∞–∑–∞–¥)")

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—Ä–æ–¥–∞—é—â–∏–µ —Å–ª–æ–≤–∞
    banned_words = [
        "—É–Ω–∏–∫–∞–ª—å–Ω—ã–π", "–Ω–µ–≤–µ—Ä–æ—è—Ç–Ω—ã–π", "–ø–æ—Ç—Ä—è—Å–∞—é—â–∏–π", "–≤–æ–ª—à–µ–±–Ω—ã–π",
        "—É–¥–∏–≤–∏—Ç–µ–ª—å–Ω—ã–π", "—Ñ–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏–π", "—Ç–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è",
        "–ø–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–Ω—Å", "—É—Å–ø–µ–π", "–Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏"
    ]
    for word in banned_words:
        if word in text.lower():
            errors.append(f"–ü—Ä–æ–¥–∞—é—â–µ–µ —Å–ª–æ–≤–æ: {word}")

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —à–∞–±–ª–æ–Ω–Ω—ã–µ –Ω–∞—á–∞–ª–∞
    bad_starts = [
        "–°–ª—É—à–∞–π,", "–î—Ä—É–∑—å—è,", "–ó–Ω–∞–µ—Ç–µ —á—Ç–æ,",
        "–í —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ", "–ú–Ω–æ–≥–∏–µ –ª—é–¥–∏",
        "–•–æ—á—É –ø–æ–¥–µ–ª–∏—Ç—å—Å—è", "–°–µ–≥–æ–¥–Ω—è —è —Ö–æ—á—É"
    ]
    for start in bad_starts:
        if text.strip().startswith(start):
            errors.append(f"–®–∞–±–ª–æ–Ω–Ω–æ–µ –Ω–∞—á–∞–ª–æ: {start}")

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–µ–º—ã –Ω–µ —Ç–≤–æ–µ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏
    forbidden_topics = [
        "–¥–µ—Ç–∏", "—Ä–µ–±—ë–Ω–æ–∫", "–¥–µ–∫—Ä–µ—Ç", "–º—É–∂ —Å–∫–∞–∑–∞–ª",
        "–∂–µ–Ω–∞ —Å–∫–∞–∑–∞–ª–∞", "–º–∞–ª—ã—à", "–≤–Ω—É–∫–∏"
    ]
    text_lower = text.lower()
    for topic in forbidden_topics:
        if topic in text_lower:
            errors.append(f"–¢–µ–º–∞ –Ω–µ —Ç–≤–æ–µ–π —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏: {topic}")

    # –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ AI-—Å–ª–æ–≤–∞
    ai_words = check_anti_ai_words(text)
    for word in ai_words:
        errors.append(f"AI-—Å–ª–æ–≤–æ: {word}")

    # –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—ã–¥—É–º–∞–Ω–Ω—ã–µ —Å—Ü–µ–Ω—ã –ø–æ–¥–≥–ª—è–¥—ã–≤–∞–Ω–∏—è
    spy_patterns = [
        r"—Å–∏–∂[—É–∞]\s+–≤\s+–º–µ—Ç—Ä–æ",
        r"—Å–∏–∂[—É–∞]\s+–≤\s+–∫–æ—Ñ–µ–π–Ω–µ",
        r"—Å—Ç–æ[—é–∞]\s+–≤\s+–ø—Ä–æ–±–∫–µ",
        r"—Å–º–æ—Ç—Ä[—é–∞]\s+–Ω–∞\s+(–ø–∞—Ä–Ω—è|–¥–µ–≤—É—à–∫—É|—á—É–≤–∞–∫–∞|—á–µ–ª–æ–≤–µ–∫–∞)",
        r"(–ø–∞—Ä–µ–Ω—å|–¥–µ–≤—É—à–∫–∞|—á—É–≤–∞–∫|—á–µ–ª–æ–≤–µ–∫)\s+(–Ω–∞–ø—Ä–æ—Ç–∏–≤|—Ä—è–¥–æ–º)",
        r"(–≤\s+–º–µ—Ç—Ä–æ|–≤\s+–∫–æ—Ñ–µ–π–Ω–µ).*—Å–º–æ—Ç—Ä",
    ]
    for pattern in spy_patterns:
        if re.search(pattern, text_lower):
            errors.append("–í—ã–¥—É–º–∞–Ω–Ω–∞—è —Å—Ü–µ–Ω–∞ –ø–æ–¥–≥–ª—è–¥—ã–≤–∞–Ω–∏—è –∑–∞ –ª—é–¥—å–º–∏")
            break

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã
    if len(text) > 1500:
        errors.append(f"–°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –ø–æ—Å—Ç ({len(text)} —Å–∏–º–≤–æ–ª–æ–≤)")

    return errors


# –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ—Å—Ç–æ–≤ –¥–ª—è —Ä–∞–Ω–¥–æ–º–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
ALL_POST_TYPES = list(POST_TYPES.keys())
